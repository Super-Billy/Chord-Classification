/home/yaxin/My_Files/ml_final/Chord-Classification/Models/Logistic/logistic.py:72: UserWarning: Some classes occur only once — using random split.
  warnings.warn("Some classes occur only once — using random split.")
✅ Device: cuda:0
✅ Hyperparameters: lr=0.0005, batch_size=64, epochs=30
✅ Total usable samples: 122912
✅ Feature matrix shape: (122912, 128)
✅ Number of classes: 320
Epoch 01/30 | Loss: 4386.3580
Epoch 02/30 | Loss: 2345.7388
Epoch 03/30 | Loss: 1983.8128
Epoch 04/30 | Loss: 1793.1786
Epoch 05/30 | Loss: 1670.9998
Epoch 06/30 | Loss: 1583.2088
Epoch 07/30 | Loss: 1517.1641
Epoch 08/30 | Loss: 1464.4043
Epoch 09/30 | Loss: 1420.8270
Epoch 10/30 | Loss: 1385.3465
Epoch 11/30 | Loss: 1353.2190
Epoch 12/30 | Loss: 1326.1219
Epoch 13/30 | Loss: 1302.8978
Epoch 14/30 | Loss: 1281.2160
Epoch 15/30 | Loss: 1262.4281
Epoch 16/30 | Loss: 1245.0046
Epoch 17/30 | Loss: 1229.7493
Epoch 18/30 | Loss: 1214.9272
Epoch 19/30 | Loss: 1202.5711
Epoch 20/30 | Loss: 1189.4496
Epoch 21/30 | Loss: 1179.0353
Epoch 22/30 | Loss: 1168.6333
Epoch 23/30 | Loss: 1158.4029
Epoch 24/30 | Loss: 1149.7877
Epoch 25/30 | Loss: 1141.2104
Epoch 26/30 | Loss: 1133.1897
Epoch 27/30 | Loss: 1125.5579
Epoch 28/30 | Loss: 1118.2113
Epoch 29/30 | Loss: 1112.3533
Epoch 30/30 | Loss: 1105.0484

✅ Final Accuracy: 0.812 | Macro F1-score: 0.455

Classification Report:
              precision    recall  f1-score   support

         A:7       0.50      0.10      0.17        10
       A:7/3       1.00      0.25      0.40         4
       A:7/5       1.00      0.67      0.80         3
      A:7/b7       1.00      0.40      0.57         5
       A:aug       0.00      0.00      0.00         1
       A:dim       1.00      0.50      0.67         4
     A:hdim7       0.50      1.00      0.67         1
       A:maj       0.85      0.96      0.90       493
     A:maj/3       0.70      0.74      0.72        19
     A:maj/5       1.00      0.14      0.25         7
      A:maj6       0.33      0.25      0.29         4
      A:maj7       0.90      0.50      0.64        18
    A:maj7/3       1.00      1.00      1.00         1
    A:maj7/5       0.00      0.00      0.00         1
    A:maj7/7       0.50      0.50      0.50         4
       A:min       0.88      0.96      0.92       397
     A:min/5       0.83      0.73      0.78        26
    A:min/b3       1.00      0.38      0.55         8
      A:min7       0.66      0.62      0.64        34
   A:min7/b7       0.86      0.29      0.43        21
      A:sus2       0.60      0.38      0.47        47
      A:sus4       0.38      0.38      0.38        13
  A:sus4(b7)       0.00      0.00      0.00         6
        Ab:7       0.50      0.25      0.33         4
      Ab:7/3       0.00      0.00      0.00         1
      Ab:7/5       1.00      0.50      0.67         2
     Ab:7/b7       1.00      0.25      0.40         4
      Ab:dim       1.00      0.80      0.89         5
     Ab:dim7       1.00      0.33      0.50         3
    Ab:hdim7       1.00      1.00      1.00         1
      Ab:maj       0.85      0.93      0.89       450
    Ab:maj/3       0.92      0.71      0.80        17
    Ab:maj/5       0.33      0.17      0.22         6
     Ab:maj6       0.60      0.33      0.43         9
     Ab:maj7       0.88      0.44      0.58        16
   Ab:maj7/5       0.50      1.00      0.67         1
   Ab:maj7/7       0.67      0.18      0.29        11
      Ab:min       0.81      0.95      0.87       259
    Ab:min/5       0.50      0.17      0.25         6
   Ab:min/b3       0.25      0.08      0.12        12
     Ab:min6       0.00      0.00      0.00         1
     Ab:min7       0.77      0.65      0.71        26
   Ab:min7/5       0.00      0.00      0.00         2
  Ab:min7/b7       0.57      0.31      0.40        13
  Ab:minmaj7       0.00      0.00      0.00         1
     Ab:sus2       0.58      0.50      0.54        42
     Ab:sus4       0.72      0.46      0.57        28
 Ab:sus4(b7)       0.44      0.44      0.44         9
         B:7       1.00      0.25      0.40         4
       B:7/5       0.00      0.00      0.00         2
      B:7/b7       0.50      0.25      0.33         4
       B:dim       0.89      0.73      0.80        11
     B:hdim7       0.50      1.00      0.67         2
       B:maj       0.83      0.94      0.88       351
     B:maj/3       0.71      0.92      0.80        13
     B:maj/5       0.56      0.22      0.31        23
      B:maj6       0.33      0.25      0.29         4
      B:maj7       0.80      0.36      0.50        11
    B:maj7/5       1.00      0.50      0.67         2
    B:maj7/7       0.67      0.40      0.50        20
       B:min       0.87      0.95      0.90       298
     B:min/5       0.33      0.12      0.18         8
    B:min/b3       0.00      0.00      0.00         1
      B:min7       0.86      0.68      0.76        62
    B:min7/5       0.00      0.00      0.00         1
   B:min7/b7       1.00      0.14      0.25        14
      B:sus2       0.77      0.53      0.63        45
      B:sus4       0.91      0.50      0.65        20
  B:sus4(b7)       0.00      0.00      0.00         6
        Bb:7       0.33      0.17      0.22         6
     Bb:7/b7       0.67      0.67      0.67         3
      Bb:dim       1.00      1.00      1.00         3
    Bb:hdim7       1.00      1.00      1.00         2
      Bb:maj       0.84      0.96      0.90       457
    Bb:maj/3       0.71      0.31      0.43        16
    Bb:maj/5       0.83      0.25      0.38        20
     Bb:maj6       0.62      0.45      0.53        11
     Bb:maj7       0.62      0.33      0.43        15
   Bb:maj7/3       0.00      0.00      0.00         2
   Bb:maj7/5       1.00      0.67      0.80         3
   Bb:maj7/7       0.00      0.00      0.00         5
      Bb:min       0.86      0.96      0.91       298
    Bb:min/5       0.50      0.25      0.33         4
   Bb:min/b3       0.50      1.00      0.67         1
     Bb:min7       0.68      0.50      0.58        42
  Bb:min7/b7       0.00      0.00      0.00         8
     Bb:sus2       0.58      0.44      0.50        43
     Bb:sus4       0.63      0.43      0.51        28
 Bb:sus4(b7)       1.00      0.31      0.47        13
        C#:7       0.60      0.60      0.60         5
      C#:7/3       0.00      0.00      0.00         1
      C#:7/5       1.00      0.17      0.29         6
     C#:7/b7       1.00      0.80      0.89         5
      C#:aug       1.00      0.50      0.67         2
      C#:dim       0.67      0.67      0.67         3
     C#:dim7       1.00      0.75      0.86         4
    C#:hdim7       0.00      0.00      0.00         2
      C#:maj       0.83      0.91      0.87       404
    C#:maj/3       0.48      0.61      0.54        18
    C#:maj/5       0.38      0.11      0.17        27
     C#:maj6       1.00      0.25      0.40         4
     C#:maj7       0.60      0.38      0.46         8
   C#:maj7/3       1.00      0.50      0.67         4
   C#:maj7/5       0.00      0.00      0.00         2
   C#:maj7/7       0.60      0.33      0.43         9
      C#:min       0.87      0.93      0.90       283
    C#:min/5       0.40      0.17      0.24        12
   C#:min/b3       0.00      0.00      0.00         6
     C#:min7       0.72      0.57      0.63        23
  C#:min7/b7       0.40      0.33      0.36         6
     C#:sus2       0.49      0.43      0.46        56
     C#:sus4       0.33      0.30      0.31        27
 C#:sus4(b7)       0.33      0.22      0.27         9
         C:7       1.00      0.33      0.50         3
       C:7/5       1.00      0.33      0.50         3
      C:7/b7       0.00      0.00      0.00         1
       C:aug       1.00      0.25      0.40         4
       C:dim       0.83      0.83      0.83         6
       C:maj       0.84      0.95      0.89       524
     C:maj/3       0.70      0.52      0.59        31
     C:maj/5       0.75      0.40      0.52        53
      C:maj6       0.50      0.17      0.25         6
      C:maj7       0.60      0.33      0.43        18
    C:maj7/3       0.50      0.25      0.33         4
    C:maj7/5       0.00      0.00      0.00         1
    C:maj7/7       0.50      0.62      0.56         8
       C:min       0.88      0.92      0.90       274
     C:min/5       0.73      0.57      0.64        14
    C:min/b3       0.25      0.09      0.13        22
      C:min7       0.71      0.54      0.61        28
    C:min7/5       1.00      0.25      0.40         4
   C:min7/b7       0.29      0.33      0.31         6
      C:sus2       0.59      0.52      0.56        84
      C:sus4       0.59      0.43      0.50        23
  C:sus4(b7)       0.40      0.25      0.31         8
         D:7       0.57      0.20      0.30        20
       D:7/3       0.00      0.00      0.00         1
       D:7/5       0.50      0.17      0.25         6
      D:7/b7       0.57      0.57      0.57         7
       D:aug       1.00      0.75      0.86         4
       D:dim       0.75      0.75      0.75         4
       D:maj       0.83      0.94      0.88       463
     D:maj/3       0.41      0.32      0.36        28
     D:maj/5       0.25      0.09      0.13        23
      D:maj6       0.00      0.00      0.00         4
      D:maj7       0.33      0.17      0.22         6
    D:maj7/5       1.00      1.00      1.00         1
    D:maj7/7       0.40      0.33      0.36         6
       D:min       0.83      0.94      0.88       313
     D:min/5       0.86      0.61      0.72        31
    D:min/b3       0.75      0.21      0.33        14
      D:min6       0.00      0.00      0.00         1
      D:min7       0.94      0.46      0.62        35
    D:min7/5       0.50      0.50      0.50         2
   D:min7/b7       0.57      0.33      0.42        12
      D:sus2       0.71      0.46      0.56        59
      D:sus4       0.50      0.40      0.44        25
  D:sus4(b7)       0.75      0.50      0.60        12
         E:7       0.86      0.86      0.86         7
       E:7/3       0.00      0.00      0.00         1
       E:7/5       1.00      1.00      1.00         1
      E:7/b7       0.00      0.00      0.00         1
       E:aug       0.00      0.00      0.00         1
       E:dim       1.00      0.67      0.80         6
     E:hdim7       1.00      0.33      0.50         3
       E:maj       0.88      0.93      0.90       460
     E:maj/3       0.68      0.58      0.62        26
     E:maj/5       0.44      0.27      0.33        15
      E:maj6       1.00      0.25      0.40         4
      E:maj7       0.40      0.17      0.24        12
    E:maj7/3       0.00      0.00      0.00         2
    E:maj7/5       1.00      1.00      1.00         1
    E:maj7/7       1.00      0.20      0.33         5
       E:min       0.88      0.95      0.91       348
     E:min/5       0.67      0.20      0.31        10
    E:min/b3       0.57      0.38      0.46        21
      E:min6       1.00      1.00      1.00         1
      E:min7       0.74      0.68      0.71        38
    E:min7/5       0.00      0.00      0.00         4
   E:min7/b7       0.33      0.17      0.22         6
      E:sus2       0.52      0.39      0.45        28
      E:sus4       0.60      0.35      0.44        26
  E:sus4(b7)       0.67      0.57      0.62         7
        Eb:7       0.70      0.88      0.78         8
      Eb:7/3       1.00      1.00      1.00         2
      Eb:7/5       0.00      0.00      0.00         1
     Eb:7/b7       0.50      0.33      0.40         3
      Eb:dim       1.00      0.50      0.67         2
    Eb:hdim7       0.00      0.00      0.00         1
      Eb:maj       0.86      0.95      0.90       453
    Eb:maj/3       0.61      0.65      0.62        31
    Eb:maj/5       0.58      0.28      0.38        25
     Eb:maj6       0.00      0.00      0.00         5
     Eb:maj7       0.60      0.55      0.57        11
   Eb:maj7/3       0.00      0.00      0.00         2
   Eb:maj7/5       1.00      1.00      1.00         1
   Eb:maj7/7       0.67      0.20      0.31        10
      Eb:min       0.86      0.94      0.90       218
    Eb:min/5       1.00      0.20      0.33         5
   Eb:min/b3       0.50      0.29      0.37        17
     Eb:min6       1.00      0.33      0.50         3
     Eb:min7       0.83      0.71      0.76        34
   Eb:min7/5       1.00      0.50      0.67         2
  Eb:min7/b7       0.33      0.14      0.20         7
     Eb:sus2       0.47      0.49      0.48        37
     Eb:sus4       0.50      0.52      0.51        27
 Eb:sus4(b7)       0.50      0.36      0.42        11
        F#:7       1.00      0.75      0.86         4
      F#:7/5       1.00      0.50      0.67         2
     F#:7/b7       0.00      0.00      0.00         4
      F#:aug       1.00      1.00      1.00         1
      F#:dim       0.67      0.80      0.73         5
    F#:hdim7       0.00      0.00      0.00         1
      F#:maj       0.85      0.95      0.90       404
    F#:maj/3       0.73      0.57      0.64        28
    F#:maj/5       1.00      0.12      0.22         8
     F#:maj6       0.00      0.00      0.00         5
     F#:maj7       0.21      0.33      0.26         9
   F#:maj7/3       0.00      0.00      0.00         1
   F#:maj7/5       1.00      0.75      0.86         4
   F#:maj7/7       0.33      0.17      0.22         6
      F#:min       0.92      0.98      0.95       287
    F#:min/5       0.80      0.50      0.62         8
   F#:min/b3       0.69      0.56      0.62        16
     F#:min7       0.65      0.61      0.63        18
  F#:min7/b7       0.00      0.00      0.00         3
     F#:sus2       0.67      0.33      0.44        43
     F#:sus4       0.20      0.21      0.21        14
 F#:sus4(b7)       0.57      0.50      0.53         8
         F:7       0.75      0.38      0.50         8
       F:7/3       1.00      0.50      0.67         2
       F:7/5       0.00      0.00      0.00         1
      F:7/b7       0.00      0.00      0.00         4
       F:dim       1.00      0.60      0.75         5
      F:dim7       0.00      0.00      0.00         1
     F:hdim7       0.00      0.00      0.00         2
       F:maj       0.85      0.94      0.89       528
     F:maj/3       0.62      0.62      0.62        16
     F:maj/5       0.67      0.29      0.40        14
      F:maj6       0.00      0.00      0.00        10
      F:maj7       0.56      0.25      0.34        20
    F:maj7/3       0.00      0.00      0.00         2
    F:maj7/5       0.00      0.00      0.00         3
    F:maj7/7       1.00      0.25      0.40         4
       F:min       0.82      0.95      0.88       277
     F:min/5       0.50      0.25      0.33         8
    F:min/b3       0.60      0.38      0.46         8
      F:min7       0.84      0.66      0.74        32
   F:min7/b7       0.33      0.14      0.20         7
      F:sus2       0.48      0.34      0.40        44
      F:sus4       0.50      0.39      0.44        18
  F:sus4(b7)       0.78      0.50      0.61        14
         G:7       0.67      0.50      0.57         4
       G:7/5       0.00      0.00      0.00         1
      G:7/b7       0.75      0.50      0.60         6
       G:dim       0.33      0.33      0.33         3
     G:hdim7       0.00      0.00      0.00         3
       G:maj       0.86      0.95      0.90       547
     G:maj/3       0.72      0.70      0.71        30
     G:maj/5       0.62      0.42      0.50        12
      G:maj6       0.50      0.50      0.50         4
      G:maj7       0.33      0.08      0.13        12
    G:maj7/3       0.50      1.00      0.67         1
    G:maj7/5       0.00      0.00      0.00         3
    G:maj7/7       0.75      0.43      0.55         7
       G:min       0.86      0.96      0.91       314
     G:min/5       0.00      0.00      0.00         3
    G:min/b3       0.80      0.44      0.57        18
      G:min7       0.57      0.50      0.53        24
    G:min7/5       0.00      0.00      0.00         1
   G:min7/b7       0.43      0.27      0.33        11
      G:sus2       0.51      0.38      0.43        48
      G:sus4       0.74      0.45      0.56        38
  G:sus4(b7)       0.58      0.47      0.52        15
           N       0.61      0.56      0.59       264

   micro avg       0.81      0.81      0.81     12292
   macro avg       0.58      0.42      0.46     12292
weighted avg       0.79      0.81      0.79     12292

Confusion Matrix:
[[  1   0   0 ...   0   0   0]
 [  0   1   0 ...   0   0   0]
 [  0   0   2 ...   0   0   0]
 ...
 [  0   0   0 ...  17   0   0]
 [  0   0   0 ...   0   7   0]
 [  0   0   0 ...   0   0 149]]
